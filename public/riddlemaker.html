<!DOCTYPE html>
<html lang="ENG">
<head>
    <title>Riddle Maker</title>
    <link rel="stylesheet" href="stylesheet.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="scripts/cipher.js"></script>
    <script src="scripts/extraction.js"></script>
    <script src="scripts/sec.js"></script>
    <link rel="shortcut icon" type="image/x-icon" href="rotw/favicon.ico"/>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>
<div class="center">
    <script>
        let riddleList;

        fetch("rotw/riddles.txt")
            .then(response => response.text())
            .then(data => {
                let input = sec(data);
                riddleList = parseRiddles(input);
            });

        function createRiddle() {
            let newRiddle;

            if(document.getElementById("question").value !== "" && document.getElementById("answer").value !== "") {
                let question = document.getElementById("question").value;
                let answer = document.getElementById("answer").value;

                // Encrypt the answer before assigning to a Riddle object
                answer = cipher(answer);

                newRiddle = new Riddle(question, answer);
            }

            document.getElementById("output").value = cipher(condenseRiddles(riddleList) + newRiddle.toString(sec));
        }

        // Takes the array of all the riddles and "condenses" it into a string
        function condenseRiddles(riddles) {
            let string = "";
            for(let i = 0; i < riddles.length; i++) {
                string += riddles[i].toString(sec);
            }

            return string;
        }
    </script>

    <div id="riddleBox">
        <label for="answer">Question / Answer:</label>
        <br>
        <input type="text" id="question"/>
        <input type="text" id="answer"/>
        <p>
        <input type="text" id="output"/>
        <p>
            <button type="submit" onclick="createRiddle()">Submit</button>

        <div id="result" style="display: none"></div>
    </div>
</div>
</body>
</html>